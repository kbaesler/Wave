<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="no-js ie6"><![endif]-->
<!--[if IE 7 ]><html class="no-js ie7"><![endif]-->
<!--[if IE 8 ]><html class="no-js ie8"><![endif]-->
<!--[if IE 9 ]><html class="no-js ie9"><![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    
      
        <title>Samples - Wave</title>
      
      
      
        <link rel="canonical" href="http://jumpercables.github.io/Wave/samples/">
      
      
        <meta name="author" content="Kyle Baesler">
      
    
    <meta property="og:url" content="http://jumpercables.github.io/Wave/samples/">
    <meta property="og:title" content="Wave">
    <meta property="og:image" content="http://jumpercables.github.io/Wave/samples//../images\wave-red-64.png">
    <meta name="apple-mobile-web-app-title" content="Wave">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
      <link rel="apple-touch-icon" href="../images\wave-red-64.png">
    
    
    <link rel="shortcut icon" type="image/x-icon" href="../None">
    <link rel="icon" type="image/x-icon" href="../None">
    <style>
      @font-face {
      	font-family: 'Icon';
      	src: url('../assets/fonts/icon.eot?52m981');
      	src: url('../assets/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
      		   url('../assets/fonts/icon.woff?52m981')
               format('woff'),
      		   url('../assets/fonts/icon.ttf?52m981')
               format('truetype'),
      		   url('../assets/fonts/icon.svg?52m981#icon')
               format('svg');
      	font-weight: normal;
      	font-style: normal;
      }
    </style>
    <link rel="stylesheet" href="../assets/stylesheets/application-54f87043f3.css">
    
      <link rel="stylesheet" href="../assets/stylesheets/palettes-05ab2406df.css">
    
    
      
      
      
      <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu+Mono">
      <style>
        body, input {
          font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
        }
        pre, code {
          font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
        }
      </style>
    
    
    <script src="../assets/javascripts/modernizr-4ab42b99fd.js"></script>
    
  </head>
  
  
  
  <body class="palette-primary-red palette-accent-teal">
    
      
      
        
      
    
    <div class="backdrop">
      <div class="backdrop-paper"></div>
    </div>
    <input class="toggle" type="checkbox" id="toggle-drawer">
    <input class="toggle" type="checkbox" id="toggle-search">
    <label class="toggle-button overlay" for="toggle-drawer"></label>
    <header class="header">
      <nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        
          <span class="path">
            
          </span>
        
        Samples
      </div>
    </div>
    
    
      
      <div class="button button-github" role="button" aria-label="GitHub">
        <a href="https://github.com/Jumpercables" title="@Jumpercables on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
      </div>
    
    <div class="button button-search" role="button" aria-label="Search">
      <label class="toggle-button icon icon-search" title="Search" for="toggle-search"></label>
    </div>
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
    </header>
    <main class="main">
      
      <div class="drawer">
        <nav aria-label="Navigation">
  
  <a href="https://github.com/Jumpercables/Wave/" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="../images\wave-red-64.png">
        </div>
      
      <div class="name">
        <strong>
          Wave
          <span class="version">
            1.0.3
          </span>
        </strong>
        
          <br>
          Jumpercables/Wave
        
      </div>
    </div>
  </a>
  <div class="scrollable">
    <div class="wrapper">
      
        <ul class="repo">
          <li class="repo-download">
            
            <a href="https://github.com/Jumpercables/Wave//archive/1.0.3.zip" target="_blank" title="Download" data-action="download">
              <i class="icon icon-download"></i> Download
            </a>
          </li>
          <li class="repo-stars">
            <a href="https://github.com/Jumpercables/Wave//stargazers" target="_blank" title="Stargazers" data-action="star">
              <i class="icon icon-star"></i> Stars
              <span class="count">&ndash;</span>
            </a>
          </li>
        </ul>
        <hr>
      
      <div class="toc">
        <ul>
          
            
  <li>
    <a class="" title="Home" href="..">
      Home
    </a>
    
  </li>

          
            
  <li>
    <a class="current" title="Samples" href="./">
      Samples
    </a>
    
      
        
      
      
        <ul>
          
            <li class="anchor">
              <a title="ArcFM Import and Export" href="#arcfm-import-and-export">
                ArcFM Import and Export
              </a>
            </li>
          
            <li class="anchor">
              <a title="Suggestions" href="#suggestions">
                Suggestions
              </a>
            </li>
          
        </ul>
      
    
  </li>

          
            
  <li>
    <a class="" title="Features" href="../features/">
      Features
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Frequently Asked Questions" href="../faq/">
      Frequently Asked Questions
    </a>
    
  </li>

          
            
  <li>
    <span class="section">About</span>
    <ul>
      
        
  <li>
    <a class="" title="Contributing" href="../contribute/">
      Contributing
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Release Notes" href="../release-notes/">
      Release Notes
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="License" href="../license/">
      License
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <a class="" title="Resources" href="../resources/">
      Resources
    </a>
    
  </li>

          
        </ul>
        
          <hr>
          <span class="section">The author</span>
          <ul>
            
            
              
              <li>
                <a href="https://github.com/Jumpercables" target="_blank" title="@Jumpercables on GitHub">
                  @Jumpercables on GitHub
                </a>
              </li>
            
          </ul>
        
      </div>
    </div>
  </div>
</nav>
      </div>
      <article class="article">
        <div class="wrapper">
          
          <h1 id="samples">Samples<a class="headerlink" href="#samples" title="Permanent link">#</a></h1>
<p>The samples are designed to give <em>&lsquo;real-life&rsquo;</em> example usages of the Wave libraries, and each will be accompanied by a <code>README.md</code> that will explain the usages in the GitHub repository.</p>
<h2 id="arcfm-import-and-export"><a href="https://github.com/Jumpercables/Wave/blob/master/samples/ArcFM%20Import%20and%20Export/README.md">ArcFM Import and Export</a><a class="headerlink" href="#arcfm-import-and-export" title="Permanent link">#</a></h2>
<p>A command line utility that will export or import the ArcFM Properties XML for all of the feature classes, tables and relationships in the given database that is specified by the connection file.</p>
<div class="code"><pre><span></span>    internal class ProgramArguments
    <span class="p">{</span>
        <span class="c1">#region Fields</span>

        <span class="p">[</span>Argument<span class="p">(</span>ArgumentType<span class="o">.</span>Required<span class="p">,</span> <span class="ss">ShortName =</span> <span class="s2">&quot;f&quot;</span><span class="p">)]</span> public string ConnectionFile<span class="p">;</span>
        <span class="p">[</span>Argument<span class="p">(</span>ArgumentType<span class="o">.</span>LastOccurenceWins<span class="p">,</span> <span class="ss">ShortName =</span> <span class="s2">&quot;d&quot;</span><span class="p">)]</span> public string <span class="ss">Directory =</span> AppDomain<span class="o">.</span>CurrentDomain<span class="o">.</span>BaseDirectory<span class="p">;</span>
        <span class="p">[</span>Argument<span class="p">(</span>ArgumentType<span class="o">.</span>LastOccurenceWins<span class="p">,</span> <span class="ss">ShortName =</span> <span class="s2">&quot;t&quot;</span><span class="p">)]</span> public ProgramTask <span class="ss">Task =</span> ProgramTask<span class="o">.</span>Export<span class="p">;</span>
        <span class="p">[</span>Argument<span class="p">(</span>ArgumentType<span class="o">.</span>LastOccurenceWins<span class="p">,</span> <span class="ss">ShortName =</span> <span class="s2">&quot;v&quot;</span><span class="p">)]</span> public string VersionNumber<span class="p">;</span>

        <span class="c1">#endregion</span>
    <span class="p">}</span>

    internal enum ProgramTask
    <span class="p">{</span>
        Import<span class="p">,</span>
        Export
    <span class="p">}</span>

    internal class Program
    <span class="p">{</span>
        <span class="c1">#region Public Methods</span>

        <span class="p">[</span>STAThread<span class="p">]</span>
        public static void Main<span class="p">(</span>string<span class="p">[]</span> args<span class="p">)</span>
        <span class="p">{</span>
            try
            <span class="p">{</span>
                var <span class="ss">pa =</span> new ProgramArguments<span class="p">();</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span>Parser<span class="o">.</span>ParseArgumentsWithUsage<span class="p">(</span>args<span class="p">,</span> pa<span class="p">))</span>
                    return<span class="p">;</span>

                new Program<span class="p">()</span><span class="o">.</span>Run<span class="p">(</span>pa<span class="p">);</span>
            <span class="p">}</span>
            catch <span class="p">(</span>Exception e<span class="p">)</span>
            <span class="p">{</span>
                Log<span class="o">.</span>Error<span class="p">(</span>typeof <span class="p">(</span>Program<span class="p">),</span> e<span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">#endregion</span>

        <span class="c1">#region Internal Methods</span>

        <span class="o">//</span><span class="err">/</span> <span class="l">&lt;summary&gt;</span>
        <span class="o">//</span><span class="err">/</span>     Exports <span class="ow">or</span> imports the XML files<span class="o">.</span>
        <span class="o">//</span><span class="err">/</span> <span class="err">&lt;</span><span class="l">/summary</span><span class="err">&gt;</span>
        <span class="o">//</span><span class="err">/</span> <span class="err">&lt;</span>param <span class="ss">name=</span><span class="s2">&quot;args&quot;</span><span class="err">&gt;</span>The arguments<span class="o">.</span><span class="err">&lt;</span><span class="l">/param</span><span class="err">&gt;</span>
        internal void Run<span class="p">(</span>ProgramArguments args<span class="p">)</span>
        <span class="p">{</span>
            using <span class="p">(</span>RuntimeAuthorization <span class="ss">lic =</span> new RuntimeAuthorization<span class="p">(</span>ProductCode<span class="o">.</span>EngineOrDesktop<span class="p">))</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span>lic<span class="o">.</span>Initialize<span class="p">(</span>esriLicenseProductCode<span class="o">.</span>esriLicenseProductCodeStandard<span class="p">,</span> mmLicensedProductCode<span class="o">.</span>mmLPArcFM<span class="p">))</span>
                <span class="p">{</span>
                    var <span class="ss">workspace =</span> WorkspaceFactories<span class="o">.</span>Open<span class="p">(</span>args<span class="o">.</span>ConnectionFile<span class="p">);</span>
                    var <span class="ss">dbi =</span> <span class="p">(</span>IDataset<span class="p">)</span> workspace<span class="p">;</span>

                    string <span class="ss">name =</span> dbi<span class="o">.</span>BrowseName<span class="p">;</span>
                    IMMProductData <span class="ss">pi =</span> new BrandingResource<span class="p">();</span>
                    string <span class="ss">versionNumber =</span> args<span class="o">.</span>VersionNumber <span class="o">??</span> pi<span class="o">.</span>ProductVersion<span class="p">();</span>

                    <span class="k">if</span> <span class="p">(</span>args<span class="o">.</span><span class="ss">Task =</span><span class="o">=</span> ProgramTask<span class="o">.</span>Export<span class="p">)</span>
                    <span class="p">{</span>
                        string <span class="ss">directory =</span> Path<span class="o">.</span>Combine<span class="p">(</span>args<span class="o">.</span>Directory<span class="p">,</span> name<span class="p">);</span>
                        <span class="k">if</span> <span class="p">(</span><span class="o">!</span>Directory<span class="o">.</span>Exists<span class="p">(</span>directory<span class="p">))</span> Directory<span class="o">.</span>CreateDirectory<span class="p">(</span>directory<span class="p">);</span>

                        Log<span class="o">.</span>Info<span class="p">(</span>this<span class="p">,</span> <span class="s2">&quot;Exporting ArcFM XML Properties&quot;</span><span class="p">);</span>
                        Log<span class="o">.</span>Info<span class="p">(</span>this<span class="p">,</span> <span class="s2">&quot;- Database: </span><span class="se">\</span><span class="s2">t{0}&quot;</span><span class="p">,</span> name<span class="p">);</span>
                        Log<span class="o">.</span>Info<span class="p">(</span>this<span class="p">,</span> <span class="s2">&quot;- Directory: </span><span class="se">\</span><span class="s2">t{0}&quot;</span><span class="p">,</span> args<span class="o">.</span>Directory<span class="p">);</span>
                        Log<span class="o">.</span>Info<span class="p">(</span>this<span class="p">,</span> <span class="s2">&quot;- Version: </span><span class="se">\</span><span class="s2">t{0}&quot;</span><span class="p">,</span> versionNumber<span class="p">);</span>

                        List<span class="l">&lt;IXMLDOMElement&gt;</span> <span class="ss">elements =</span> new List<span class="l">&lt;IXMLDOMElement&gt;</span><span class="p">();</span>
                        elements<span class="o">.</span>AddRange<span class="p">(</span>this<span class="o">.</span>ExportFeatureClasses<span class="p">(</span>workspace<span class="p">,</span> directory<span class="p">,</span> versionNumber<span class="p">));</span>
                        elements<span class="o">.</span>AddRange<span class="p">(</span>this<span class="o">.</span>ExportTables<span class="p">(</span>workspace<span class="p">,</span> directory<span class="p">,</span> versionNumber<span class="p">));</span>
                        elements<span class="o">.</span>AddRange<span class="p">(</span>this<span class="o">.</span>ExportRelationships<span class="p">(</span>workspace<span class="p">,</span> directory<span class="p">,</span> versionNumber<span class="p">));</span>

                        <span class="k">if</span> <span class="p">(</span>elements<span class="o">.</span>Any<span class="p">())</span>
                        <span class="p">{</span>
                            var <span class="ss">doc =</span> this<span class="o">.</span>CreateDocument<span class="p">(</span>versionNumber<span class="p">);</span>

                            foreach <span class="p">(</span>var element <span class="k">in</span> elements<span class="p">)</span>
                            <span class="p">{</span>
                                doc<span class="o">.</span>lastChild<span class="o">.</span>appendChild<span class="p">(</span>element<span class="p">);</span>
                            <span class="p">}</span>

                            string <span class="ss">fileName =</span> Path<span class="o">.</span>Combine<span class="p">(</span>args<span class="o">.</span>Directory<span class="p">,</span> name <span class="o">+</span> <span class="s2">&quot;.xml&quot;</span><span class="p">);</span>
                            XDocument <span class="ss">xdoc =</span> XDocument<span class="o">.</span>Parse<span class="p">(</span>doc<span class="o">.</span>xml<span class="p">);</span>
                            xdoc<span class="o">.</span>Save<span class="p">(</span>fileName<span class="p">,</span> SaveOptions<span class="o">.</span>None<span class="p">);</span>

                            Log<span class="o">.</span>Info<span class="p">(</span>this<span class="p">,</span> <span class="s2">&quot;{0}: </span><span class="se">\</span><span class="s2">t{1}&quot;</span><span class="p">,</span> name<span class="p">,</span> fileName<span class="p">);</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                    <span class="k">else</span>
                    <span class="p">{</span>
                        Log<span class="o">.</span>Info<span class="p">(</span>this<span class="p">,</span> <span class="s2">&quot;Importing ArcFM XML Properties&quot;</span><span class="p">);</span>
                        Log<span class="o">.</span>Info<span class="p">(</span>this<span class="p">,</span> <span class="s2">&quot;- Database: </span><span class="se">\</span><span class="s2">t{0}&quot;</span><span class="p">,</span> name<span class="p">);</span>
                        Log<span class="o">.</span>Info<span class="p">(</span>this<span class="p">,</span> <span class="s2">&quot;- Directory: </span><span class="se">\</span><span class="s2">t{0}&quot;</span><span class="p">,</span> args<span class="o">.</span>Directory<span class="p">);</span>
                        Log<span class="o">.</span>Info<span class="p">(</span>this<span class="p">,</span> <span class="s2">&quot;- Version: </span><span class="se">\</span><span class="s2">t{0}&quot;</span><span class="p">,</span> versionNumber<span class="p">);</span>

                        var <span class="ss">files =</span> Directory<span class="o">.</span>GetFiles<span class="p">(</span>Path<span class="o">.</span>GetFullPath<span class="p">(</span>args<span class="o">.</span>Directory<span class="p">),</span> <span class="s2">&quot;*.xml&quot;</span><span class="p">,</span> SearchOption<span class="o">.</span>AllDirectories<span class="p">);</span>
                        this<span class="o">.</span>Import<span class="p">(</span>workspace<span class="p">,</span> files<span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">#endregion</span>

        <span class="c1">#region Private Methods</span>

        <span class="o">//</span><span class="err">/</span> <span class="l">&lt;summary&gt;</span>
        <span class="o">//</span><span class="err">/</span>     Creates the root document for the XML<span class="o">.</span>
        <span class="o">//</span><span class="err">/</span> <span class="err">&lt;</span><span class="l">/summary</span><span class="err">&gt;</span>
        <span class="o">//</span><span class="err">/</span> <span class="err">&lt;</span>param <span class="ss">name=</span><span class="s2">&quot;versionNumber&quot;</span><span class="err">&gt;</span>The version number<span class="o">.</span><span class="err">&lt;</span><span class="l">/param</span><span class="err">&gt;</span>
        <span class="o">//</span><span class="err">/</span> <span class="l">&lt;returns&gt;</span>Returns a <span class="err">&lt;</span>see <span class="ss">cref=</span><span class="s2">&quot;IXMLDOMDocument&quot;</span> <span class="err">/&gt;</span> representing the root document for the XML<span class="o">.</span><span class="err">&lt;</span><span class="l">/returns</span><span class="err">&gt;</span>
        private IXMLDOMDocument CreateDocument<span class="p">(</span>string versionNumber<span class="p">)</span>
        <span class="p">{</span>
            IXMLDOMDocument <span class="ss">doc =</span> new DOMDocumentClass<span class="p">();</span>
            var <span class="ss">element =</span> doc<span class="o">.</span>createElement<span class="p">(</span><span class="s2">&quot;GXXML&quot;</span><span class="p">);</span>
            doc<span class="o">.</span>appendChild<span class="p">(</span>element<span class="p">);</span>

            <span class="ss">element =</span> doc<span class="o">.</span>createElement<span class="p">(</span><span class="s2">&quot;EXPORT_VERSION&quot;</span><span class="p">);</span>
            element<span class="o">.</span><span class="ss">text =</span> versionNumber<span class="p">;</span>
            doc<span class="o">.</span>firstChild<span class="o">.</span>appendChild<span class="p">(</span>element<span class="p">);</span>

            return doc<span class="p">;</span>
        <span class="p">}</span>

        <span class="o">//</span><span class="err">/</span> <span class="l">&lt;summary&gt;</span>
        <span class="o">//</span><span class="err">/</span>     Exports the objects represeted <span class="k">in</span> the grouped list<span class="o">.</span>
        <span class="o">//</span><span class="err">/</span> <span class="err">&lt;</span><span class="l">/summary</span><span class="err">&gt;</span>
        <span class="o">//</span><span class="err">/</span> <span class="err">&lt;</span>typeparam <span class="ss">name=</span><span class="s2">&quot;T&quot;</span><span class="err">&gt;&lt;</span><span class="l">/typeparam</span><span class="err">&gt;</span>
        <span class="o">//</span><span class="err">/</span> <span class="err">&lt;</span>param <span class="ss">name=</span><span class="s2">&quot;directory&quot;</span><span class="err">&gt;</span>The directory<span class="o">.</span><span class="err">&lt;</span><span class="l">/param</span><span class="err">&gt;</span>
        <span class="o">//</span><span class="err">/</span> <span class="err">&lt;</span>param <span class="ss">name=</span><span class="s2">&quot;versionNumber&quot;</span><span class="err">&gt;</span>The version number<span class="o">.</span><span class="err">&lt;</span><span class="l">/param</span><span class="err">&gt;</span>
        <span class="o">//</span><span class="err">/</span> <span class="err">&lt;</span>param <span class="ss">name=</span><span class="s2">&quot;ie&quot;</span><span class="err">&gt;</span>The <span class="nb">import</span> <span class="err">/</span> export interface used to create the XML<span class="o">.</span><span class="err">&lt;</span><span class="l">/param</span><span class="err">&gt;</span>
        <span class="o">//</span><span class="err">/</span> <span class="err">&lt;</span>param <span class="ss">name=</span><span class="s2">&quot;list&quot;</span><span class="err">&gt;</span>The list<span class="o">.</span><span class="err">&lt;</span><span class="l">/param</span><span class="err">&gt;</span>
        <span class="o">//</span><span class="err">/</span> <span class="l">&lt;returns&gt;</span>Returns a <span class="err">&lt;</span>see <span class="ss">cref=</span><span class="s2">&quot;IEnumerable{IXMLDOMElement}&quot;</span> <span class="err">/&gt;</span> representing the XML of the objects<span class="o">.</span><span class="err">&lt;</span><span class="l">/returns</span><span class="err">&gt;</span>
        private IEnumerable<span class="l">&lt;IXMLDOMElement&gt;</span> Export<span class="l">&lt;T&gt;</span><span class="p">(</span>string directory<span class="p">,</span> string versionNumber<span class="p">,</span> IMMXMLImportExport4 ie<span class="p">,</span> IEnumerable<span class="err">&lt;</span>IGrouping<span class="err">&lt;</span>string<span class="p">,</span> T<span class="err">&gt;&gt;</span> list<span class="p">)</span>
        <span class="p">{</span>
            foreach <span class="p">(</span>var grouping <span class="k">in</span> list<span class="p">)</span>
            <span class="p">{</span>
                Log<span class="o">.</span>Info<span class="p">(</span>this<span class="p">,</span> <span class="s2">&quot;Feature Dataset: {0}&quot;</span><span class="p">,</span> grouping<span class="o">.</span>Key<span class="p">);</span>

                string <span class="ss">subdirectory =</span> Path<span class="o">.</span>Combine<span class="p">(</span>directory<span class="p">,</span> grouping<span class="o">.</span>Key<span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span>Directory<span class="o">.</span>Exists<span class="p">(</span>subdirectory<span class="p">))</span> Directory<span class="o">.</span>CreateDirectory<span class="p">(</span>subdirectory<span class="p">);</span>

                foreach <span class="p">(</span>var table <span class="k">in</span> grouping<span class="p">)</span>
                <span class="p">{</span>
                    IXMLDOMDocument <span class="ss">doc =</span> this<span class="o">.</span>CreateDocument<span class="p">(</span>versionNumber<span class="p">);</span>
                    var <span class="ss">element =</span> ie<span class="o">.</span>Export<span class="p">(((</span>IDataset<span class="p">)</span> table<span class="p">));</span>
                    <span class="k">if</span> <span class="p">(</span>element <span class="o">!=</span> <span class="no">null</span><span class="p">)</span>
                    <span class="p">{</span>
                        doc<span class="o">.</span>lastChild<span class="o">.</span>appendChild<span class="p">(</span>element<span class="p">);</span>

                        string <span class="ss">name =</span> <span class="p">((</span>IDataset<span class="p">)</span> table<span class="p">)</span><span class="o">.</span>Name<span class="p">;</span>
                        string <span class="ss">fileName =</span> Path<span class="o">.</span>Combine<span class="p">(</span>subdirectory<span class="p">,</span> name <span class="o">+</span> <span class="s2">&quot;.XML&quot;</span><span class="p">);</span>

                        XDocument <span class="ss">xdoc =</span> XDocument<span class="o">.</span>Parse<span class="p">(</span>doc<span class="o">.</span>xml<span class="p">);</span>
                        xdoc<span class="o">.</span>Save<span class="p">(</span>fileName<span class="p">,</span> SaveOptions<span class="o">.</span>None<span class="p">);</span>

                        Log<span class="o">.</span>Info<span class="p">(</span>this<span class="p">,</span> <span class="s2">&quot;</span><span class="se">\</span><span class="s2">t{0}&quot;</span><span class="p">,</span> name<span class="p">);</span>

                        yield return element<span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="o">//</span><span class="err">/</span> <span class="l">&lt;summary&gt;</span>
        <span class="o">//</span><span class="err">/</span>     Exports the feature classes<span class="o">.</span>
        <span class="o">//</span><span class="err">/</span> <span class="err">&lt;</span><span class="l">/summary</span><span class="err">&gt;</span>
        <span class="o">//</span><span class="err">/</span> <span class="err">&lt;</span>param <span class="ss">name=</span><span class="s2">&quot;workspace&quot;</span><span class="err">&gt;</span>The workspace<span class="o">.</span><span class="err">&lt;</span><span class="l">/param</span><span class="err">&gt;</span>
        <span class="o">//</span><span class="err">/</span> <span class="err">&lt;</span>param <span class="ss">name=</span><span class="s2">&quot;directory&quot;</span><span class="err">&gt;</span>The directory<span class="o">.</span><span class="err">&lt;</span><span class="l">/param</span><span class="err">&gt;</span>
        <span class="o">//</span><span class="err">/</span> <span class="err">&lt;</span>param <span class="ss">name=</span><span class="s2">&quot;versionNumber&quot;</span><span class="err">&gt;</span>The version number<span class="o">.</span><span class="err">&lt;</span><span class="l">/param</span><span class="err">&gt;</span>
        <span class="o">//</span><span class="err">/</span> <span class="l">&lt;returns&gt;</span>Returns a <span class="err">&lt;</span>see <span class="ss">cref=</span><span class="s2">&quot;IEnumerable{IXMLDOMElement}&quot;</span> <span class="err">/&gt;</span> representing the XML of the objects<span class="o">.</span><span class="err">&lt;</span><span class="l">/returns</span><span class="err">&gt;</span>
        private IEnumerable<span class="l">&lt;IXMLDOMElement&gt;</span> ExportFeatureClasses<span class="p">(</span>IWorkspace workspace<span class="p">,</span> string directory<span class="p">,</span> string versionNumber<span class="p">)</span>
        <span class="p">{</span>
            IMMXMLImportExport4 <span class="ss">ie =</span> new MMFieldInfoIEClass<span class="p">();</span>
            return this<span class="o">.</span>Export<span class="p">(</span>directory<span class="p">,</span> versionNumber<span class="p">,</span> ie<span class="p">,</span> workspace<span class="o">.</span>GetFeatureClasses<span class="p">()</span><span class="o">.</span>GroupBy<span class="p">(</span><span class="ss">kvp =</span><span class="err">&gt;</span> <span class="p">(</span>kvp<span class="o">.</span>FeatureDataset <span class="o">!=</span> <span class="no">null</span><span class="p">)</span> <span class="o">?</span> kvp<span class="o">.</span>FeatureDataset<span class="o">.</span>Name <span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">));</span>
        <span class="p">}</span>

        <span class="o">//</span><span class="err">/</span> <span class="l">&lt;summary&gt;</span>
        <span class="o">//</span><span class="err">/</span>     Exports the relationships<span class="o">.</span>
        <span class="o">//</span><span class="err">/</span> <span class="err">&lt;</span><span class="l">/summary</span><span class="err">&gt;</span>
        <span class="o">//</span><span class="err">/</span> <span class="err">&lt;</span>param <span class="ss">name=</span><span class="s2">&quot;workspace&quot;</span><span class="err">&gt;</span>The workspace<span class="o">.</span><span class="err">&lt;</span><span class="l">/param</span><span class="err">&gt;</span>
        <span class="o">//</span><span class="err">/</span> <span class="err">&lt;</span>param <span class="ss">name=</span><span class="s2">&quot;directory&quot;</span><span class="err">&gt;</span>The directory<span class="o">.</span><span class="err">&lt;</span><span class="l">/param</span><span class="err">&gt;</span>
        <span class="o">//</span><span class="err">/</span> <span class="err">&lt;</span>param <span class="ss">name=</span><span class="s2">&quot;versionNumber&quot;</span><span class="err">&gt;</span>The version number<span class="o">.</span><span class="err">&lt;</span><span class="l">/param</span><span class="err">&gt;</span>
        <span class="o">//</span><span class="err">/</span> <span class="l">&lt;returns&gt;</span>Returns a <span class="err">&lt;</span>see <span class="ss">cref=</span><span class="s2">&quot;IEnumerable{IXMLDOMElement}&quot;</span> <span class="err">/&gt;</span> representing the XML of the objects<span class="o">.</span><span class="err">&lt;</span><span class="l">/returns</span><span class="err">&gt;</span>
        private IEnumerable<span class="l">&lt;IXMLDOMElement&gt;</span> ExportRelationships<span class="p">(</span>IWorkspace workspace<span class="p">,</span> string directory<span class="p">,</span> string versionNumber<span class="p">)</span>
        <span class="p">{</span>
            IMMXMLImportExport4 <span class="ss">ie =</span> new MMRelClassIEClass<span class="p">();</span>
            return this<span class="o">.</span>Export<span class="p">(</span>directory<span class="p">,</span> versionNumber<span class="p">,</span> ie<span class="p">,</span> workspace<span class="o">.</span>GetRelationshipClasses<span class="p">()</span><span class="o">.</span>GroupBy<span class="p">(</span><span class="ss">kvp =</span><span class="err">&gt;</span> <span class="p">(</span>kvp<span class="o">.</span>FeatureDataset <span class="o">!=</span> <span class="no">null</span><span class="p">)</span> <span class="o">?</span> kvp<span class="o">.</span>FeatureDataset<span class="o">.</span>Name <span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">));</span>
        <span class="p">}</span>

        <span class="o">//</span><span class="err">/</span> <span class="l">&lt;summary&gt;</span>
        <span class="o">//</span><span class="err">/</span>     Exports the tables<span class="o">.</span>
        <span class="o">//</span><span class="err">/</span> <span class="err">&lt;</span><span class="l">/summary</span><span class="err">&gt;</span>
        <span class="o">//</span><span class="err">/</span> <span class="err">&lt;</span>param <span class="ss">name=</span><span class="s2">&quot;workspace&quot;</span><span class="err">&gt;</span>The workspace<span class="o">.</span><span class="err">&lt;</span><span class="l">/param</span><span class="err">&gt;</span>
        <span class="o">//</span><span class="err">/</span> <span class="err">&lt;</span>param <span class="ss">name=</span><span class="s2">&quot;directory&quot;</span><span class="err">&gt;</span>The directory<span class="o">.</span><span class="err">&lt;</span><span class="l">/param</span><span class="err">&gt;</span>
        <span class="o">//</span><span class="err">/</span> <span class="err">&lt;</span>param <span class="ss">name=</span><span class="s2">&quot;versionNumber&quot;</span><span class="err">&gt;</span>The version number<span class="o">.</span><span class="err">&lt;</span><span class="l">/param</span><span class="err">&gt;</span>
        <span class="o">//</span><span class="err">/</span> <span class="l">&lt;returns&gt;</span>Returns a <span class="err">&lt;</span>see <span class="ss">cref=</span><span class="s2">&quot;IEnumerable{IXMLDOMElement}&quot;</span> <span class="err">/&gt;</span> representing the XML of the objects<span class="o">.</span><span class="err">&lt;</span><span class="l">/returns</span><span class="err">&gt;</span>
        private IEnumerable<span class="l">&lt;IXMLDOMElement&gt;</span> ExportTables<span class="p">(</span>IWorkspace workspace<span class="p">,</span> string directory<span class="p">,</span> string versionNumber<span class="p">)</span>
        <span class="p">{</span>
            IMMXMLImportExport4 <span class="ss">ie =</span> new MMFieldInfoIEClass<span class="p">();</span>
            return this<span class="o">.</span>Export<span class="p">(</span>directory<span class="p">,</span> versionNumber<span class="p">,</span> ie<span class="p">,</span> workspace<span class="o">.</span>GetTables<span class="p">()</span><span class="o">.</span>GroupBy<span class="p">(</span><span class="ss">kvp =</span><span class="err">&gt;</span> <span class="s2">&quot;&quot;</span><span class="p">));</span>
        <span class="p">}</span>

        <span class="o">//</span><span class="err">/</span> <span class="l">&lt;summary&gt;</span>
        <span class="o">//</span><span class="err">/</span>     Imports the specified files into the workspace<span class="o">.</span>
        <span class="o">//</span><span class="err">/</span> <span class="err">&lt;</span><span class="l">/summary</span><span class="err">&gt;</span>
        <span class="o">//</span><span class="err">/</span> <span class="err">&lt;</span>param <span class="ss">name=</span><span class="s2">&quot;workspace&quot;</span><span class="err">&gt;</span>The workspace<span class="o">.</span><span class="err">&lt;</span><span class="l">/param</span><span class="err">&gt;</span>
        <span class="o">//</span><span class="err">/</span> <span class="err">&lt;</span>param <span class="ss">name=</span><span class="s2">&quot;fileNames&quot;</span><span class="err">&gt;</span>The file names<span class="o">.</span><span class="err">&lt;</span><span class="l">/param</span><span class="err">&gt;</span>
        private void Import<span class="p">(</span>IWorkspace workspace<span class="p">,</span> string<span class="p">[]</span> fileNames<span class="p">)</span>
        <span class="p">{</span>
            Log<span class="o">.</span>Info<span class="p">(</span>this<span class="p">,</span> <span class="s2">&quot;- Import File(s): </span><span class="se">\</span><span class="s2">t{0}&quot;</span><span class="p">,</span> fileNames<span class="o">.</span>Length<span class="p">);</span>

            var <span class="ss">ies =</span> new Dictionary<span class="err">&lt;</span>string<span class="p">,</span> IMMXMLImportExport4<span class="err">&gt;</span><span class="p">()</span>
            <span class="p">{</span>
                <span class="p">{</span><span class="s2">&quot;MMFieldInfoIE&quot;</span><span class="p">,</span> new MMFieldInfoIEClass<span class="p">()},</span>
                <span class="p">{</span><span class="s2">&quot;MMObjClassIE&quot;</span><span class="p">,</span> new MMObjClassIEClass<span class="p">()},</span>
                <span class="p">{</span><span class="s2">&quot;MMRelClassIE&quot;</span><span class="p">,</span> new MMRelClassIEClass<span class="p">()}</span>
            <span class="p">};</span>

            var <span class="ss">utils =</span> new mmFrameworkUtilitiesClass<span class="p">();</span>

            foreach <span class="p">(</span>var fileName <span class="k">in</span> fileNames<span class="p">)</span>
            <span class="p">{</span>
                var <span class="ss">fileName1 =</span> fileName<span class="p">;</span>

                workspace<span class="o">.</span>PerformOperation<span class="p">(()</span> <span class="o">=</span><span class="err">&gt;</span>
                <span class="p">{</span>
                    IXMLDOMDocument <span class="ss">doc =</span> new DOMDocumentClass<span class="p">();</span>
                    <span class="k">if</span> <span class="p">(</span>doc<span class="o">.</span>load<span class="p">(</span>fileName1<span class="p">))</span>
                    <span class="p">{</span>
                        var <span class="ss">dtd =</span> utils<span class="o">.</span>AddDTD<span class="p">(</span>mmTopLevelType<span class="o">.</span>GXXMLTOPLEVEL<span class="p">,</span> ref doc<span class="p">);</span>
                        <span class="k">if</span> <span class="p">(</span>dtd <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> return <span class="no">false</span><span class="p">;</span>

                        var <span class="ss">nodes =</span> doc<span class="o">.</span>getElementsByTagName<span class="p">(</span><span class="s2">&quot;IEPROGID&quot;</span><span class="p">);</span>
                        nodes<span class="o">.</span>reset<span class="p">();</span>

                        IXMLDOMElement element<span class="p">;</span>
                        while <span class="p">((</span><span class="ss">element =</span> nodes<span class="o">.</span>nextNode<span class="p">()</span> as IXMLDOMElement<span class="p">)</span> <span class="o">!=</span> <span class="no">null</span><span class="p">)</span>
                        <span class="p">{</span>
                            var <span class="ss">ie =</span> ies<span class="o">.</span>FirstOrDefault<span class="p">(</span><span class="ss">kvp =</span><span class="err">&gt;</span> element<span class="o">.</span>text<span class="o">.</span>EndsWith<span class="p">(</span>kvp<span class="o">.</span>Key<span class="p">,</span> StringComparison<span class="o">.</span>InvariantCultureIgnoreCase<span class="p">));</span>
                            this<span class="o">.</span>Import<span class="p">(</span>workspace<span class="p">,</span> ie<span class="o">.</span>Value<span class="p">,</span> <span class="p">(</span>IXMLDOMElement<span class="p">)</span> element<span class="o">.</span>parentNode<span class="p">);</span>
                        <span class="p">}</span>
                    <span class="p">}</span>

                    return <span class="no">true</span><span class="p">;</span>
                <span class="p">});</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="o">//</span><span class="err">/</span> <span class="l">&lt;summary&gt;</span>
        <span class="o">//</span><span class="err">/</span>     Imports the specified element into the workspace using the importer<span class="o">.</span>
        <span class="o">//</span><span class="err">/</span> <span class="err">&lt;</span><span class="l">/summary</span><span class="err">&gt;</span>
        <span class="o">//</span><span class="err">/</span> <span class="err">&lt;</span>param <span class="ss">name=</span><span class="s2">&quot;workspace&quot;</span><span class="err">&gt;</span>The workspace<span class="o">.</span><span class="err">&lt;</span><span class="l">/param</span><span class="err">&gt;</span>
        <span class="o">//</span><span class="err">/</span> <span class="err">&lt;</span>param <span class="ss">name=</span><span class="s2">&quot;ie&quot;</span><span class="err">&gt;</span>The importer<span class="o">.</span><span class="err">&lt;</span><span class="l">/param</span><span class="err">&gt;</span>
        <span class="o">//</span><span class="err">/</span> <span class="err">&lt;</span>param <span class="ss">name=</span><span class="s2">&quot;element&quot;</span><span class="err">&gt;</span>The element<span class="o">.</span><span class="err">&lt;</span><span class="l">/param</span><span class="err">&gt;</span>
        private void Import<span class="p">(</span>IWorkspace workspace<span class="p">,</span> IMMXMLImportExport4 ie<span class="p">,</span> IXMLDOMElement element<span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="ss">ie =</span><span class="o">=</span> <span class="no">null</span><span class="p">)</span> return<span class="p">;</span>

            var <span class="ss">node =</span> element<span class="o">.</span>selectSingleNode<span class="p">(</span><span class="s2">&quot;FEATURENAME&quot;</span><span class="p">)</span> <span class="o">??</span> element<span class="o">.</span>selectSingleNode<span class="p">(</span><span class="s2">&quot;NAME&quot;</span><span class="p">);</span>

            Log<span class="o">.</span>Info<span class="p">(</span>this<span class="p">,</span> <span class="s2">&quot;{0}:&quot;</span><span class="p">,</span> node<span class="o">.</span>text<span class="p">);</span>

            try
            <span class="p">{</span>
                var <span class="ss">success =</span> ie<span class="o">.</span>Import<span class="p">(</span>workspace<span class="p">,</span> element<span class="p">,</span> mmGxXMLOptions<span class="o">.</span>mmGXOOverwrite<span class="p">,</span> mmGxXMLSubtypeOptions<span class="o">.</span>mmGXOReplace<span class="p">);</span>
                Log<span class="o">.</span>Info<span class="p">(</span>this<span class="p">,</span> <span class="s2">&quot;</span><span class="se">\</span><span class="s2">t{0} =&gt; {1}&quot;</span><span class="p">,</span> ie<span class="o">.</span>DisplayName<span class="p">,</span> success <span class="o">?</span> <span class="s2">&quot;SUCCESS&quot;</span> <span class="p">:</span> <span class="s2">&quot;FAILED&quot;</span><span class="p">);</span>
            <span class="p">}</span>
            catch <span class="p">(</span>Exception e<span class="p">)</span>
            <span class="p">{</span>
                Log<span class="o">.</span>Error<span class="p">(</span>this<span class="p">,</span> string<span class="o">.</span>Format<span class="p">(</span><span class="s2">&quot;</span><span class="se">\</span><span class="s2">t{0} =&gt; {1}&quot;</span><span class="p">,</span> ie<span class="o">.</span>DisplayName<span class="p">,</span> e<span class="o">.</span>Message<span class="p">));</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">#endregion</span>
    <span class="p">}</span>
</pre></div>


<h2 id="suggestions">Suggestions<a class="headerlink" href="#suggestions" title="Permanent link">#</a></h2>
<p>Your feedback is important, make suggestions for samples. If you have a suggestion please submit an issue on our GitHub <a href="https://github.com/Jumpercables/Wave/issues">issue tracker</a>.</p>
          <aside class="copyright" role="note">
            
              Copyright (c) 2016 Kyle Baesler &ndash;
            
            Documentation built with
            <a href="http://www.mkdocs.org" target="_blank">MkDocs</a>
            using the
            <a href="http://squidfunk.github.io/mkdocs-material/" target="_blank">
              Material
            </a>
            theme.
          </aside>
          
            <footer class="footer">
              
  <nav class="pagination" aria-label="Footer">
    <div class="previous">
      
        <a href=".." title="Home">
          <span class="direction">
            Previous
          </span>
          <div class="page">
            <div class="button button-previous" role="button" aria-label="Previous">
              <i class="icon icon-back"></i>
            </div>
            <div class="stretch">
              <div class="title">
                Home
              </div>
            </div>
          </div>
        </a>
      
    </div>
    <div class="next">
      
        <a href="../features/" title="Features">
          <span class="direction">
            Next
          </span>
          <div class="page">
            <div class="stretch">
              <div class="title">
                Features
              </div>
            </div>
            <div class="button button-next" role="button" aria-label="Next">
              <i class="icon icon-forward"></i>
            </div>
          </div>
        </a>
      
    </div>
  </nav>

            </footer>
          
        </div>
      </article>
      <div class="results" role="status" aria-live="polite">
        <div class="scrollable">
          <div class="wrapper">
            <div class="meta"></div>
            <div class="list"></div>
          </div>
        </div>
      </div>
    </main>
    <script>
      var base_url = '..';
      var repo_id  = 'Jumpercables/Wave';
    </script>
    <script src="../assets/javascripts/application-997097ee0c.js"></script>
    
    
  </body>
</html>